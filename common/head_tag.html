<script type="text/discourse-plugin" version="0.8"> 
  const observes = require("ember-addons/ember-computed-decorators").observes;
 
  api.modifyClass("component:composer-title", {
    keyDown(event) {
      const creatingPrivateMessage = this.get('composer.creatingPrivateMessage');
      const isPrivateMessage = this.get('composer.topic.isPrivateMessage');

      if (event.keyCode === 8 ||
          event.keyCode === 46 ||
          creatingPrivateMessage ||
          isPrivateMessage) {
        return;
      }
      
      const $title = this.$('#reply-title');
      const value = $title.val();
      if (value.length === 0) {
        $title.val('?');
        this.setCaretPosition('reply-title', 0);
      }
    },
    
    setCaretPosition(elemId, caretPos) {
      var elem = document.getElementById(elemId);
      if (elem != null) {
        if (elem.createTextRange) {
          var range = elem.createTextRange();
          range.move('character', caretPos);
          range.select();
        } else {
          if (elem.selectionStart) {
            elem.focus();
            elem.setSelectionRange(caretPos, caretPos);
          } else {
            elem.focus();
          }  
        }
      }
    }
  });
</script>